# Environment Variables Setup Instructions

## OpenAI API Key Configuration (SECURE)

1. **Create .env file** (if not already created):
   ```bash
   cp .env.example .env
   ```

2. **Add your OpenAI API key** to the .env file:
   ```
   OPENAI_API_KEY=sk-your-actual-api-key-here
   ```

3. **IMPORTANT: Restart the development server**:
   - Stop the current server (Ctrl+C)
   - Start it again: `npm run dev`

## Security Improvements

✅ **API Key Security**: API key is now stored server-side only
✅ **Rate Limiting**: 5 AI requests per minute per IP address
✅ **Input Validation**: All user inputs are validated and sanitized
✅ **Error Handling**: Proper error messages without exposing sensitive info

## Troubleshooting

If the AI generation is not working:

1. **Check the .env file format**:
   - No quotes around the API key
   - No spaces around the equals sign
   - The key should start with `sk-`
   - Variable name is `OPENAI_API_KEY` (not VITE_AI_API_KEY)

2. **Verify server logs**:
   - Check the console for "AI Service initialized" message
   - Look for any error messages in server logs

3. **Clear cache** (if needed):
   ```bash
   rm -rf node_modules/.vite
   npm run dev
   ```

4. **Test the endpoint**:
   - Try using a simple topic like "animals" or "space"
   - Check browser network tab for API call status

## Production Security

For production deployment:
- Set `NODE_ENV=production` 
- Set `ALLOWED_ORIGIN=https://yourdomain.com`
- Never expose API keys to the client
- Consider additional rate limiting with Redis
- Use HTTPS only